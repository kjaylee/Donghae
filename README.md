# Donghae

**Donghae**는 Mac 플랫폼 전용으로 구현된 Zig 기반 블록체인 네트워크로, CoreML 서비스를 제공하기 위해 설계되었습니다.  
"동해(東海)"는 동쪽 바다의 넓고 깊은 이미지를 상징하며, Donghae는 CoreML의 강력한 머신러닝 기능을 블록체인 네트워크에 통합하여, 확장성과 신뢰성을 확보하는 것을 목표로 합니다.

---

## 목차

- [Donghae](#donghae)
  - [목차](#목차)
  - [1. 프로젝트 개요](#1-프로젝트-개요)
  - [2. 주요 특징](#2-주요-특징)
  - [3. NAT 트래버설 전략](#3-nat-트래버설-전략)
  - [4. 플랫폼 및 CoreML 서비스 통합](#4-플랫폼-및-coreml-서비스-통합)
  - [5. 활용 오픈 소스](#5-활용-오픈-소스)
  - [6. 테스트 및 배포 전략](#6-테스트-및-배포-전략)
  - [7. 요약](#7-요약)

---

## 1. 프로젝트 개요

Donghae는 Mac 환경에서 CoreML 기반 서비스를 제공하기 위한 전용 블록체인 플랫폼입니다.  
Zig 언어로 구현된 Donghae는 높은 성능과 낮은 오버헤드를 자랑하며, CoreML 모델을 블록체인 노드에서 직접 실행하여, 머신러닝 추론 기능을 분산형 서비스로 제공합니다.

---

## 2. 주요 특징

1. **Zig로 구현된 안전하고 효율적인 코드베이스**  
   - Mac 전용 환경에서 최적화된 코드와 낮은 오버헤드를 제공  
   - 강력한 컴파일 타임 검증으로 메모리 안전성과 신뢰성을 확보

2. **QUIC 프로토콜을 통한 네트워크 통신 최적화**  
   - 빠른 연결 수립 및 낮은 지연 시간 제공  
   - UDP 기반 전송과 내장 TLS 1.3 암호화를 통해 보안성이 강화됨

3. **PoH (Proof of History)를 통한 시간 순서 증명**  
   - 블록 생성 시간과 순서를 암호학적으로 증명하여, 블록체인의 무결성과 신뢰성을 유지

4. **Swarm Intelligence 기반 합의 알고리즘**  
   - 중앙 제어 없이 노드 간 로컬 상호작용을 통해 효율적이고 확장 가능한 합의 도출

5. **자동 NAT 트래버설**  
   - **NAT-PMP 우선:**  
     - 간단한 프로토콜 구조와 빠른 설정, 특히 애플 생태계(macOS)에서 높은 신뢰성을 제공  
   - **UPnP 페일오버:**  
     - NAT-PMP가 지원되지 않거나 실패할 경우, 대부분의 소비자용 라우터가 지원하는 UPnP를 자동으로 사용하여 포트 매핑을 재시도

6. **플랫폼 및 CoreML 서비스 통합**  
   - Mac 환경에 최적화된 하드웨어와 소프트웨어를 기반으로, CoreML 모델을 직접 실행하여 분산형 머신러닝 추론 서비스를 제공  
   - 노드들은 CoreML을 이용해 데이터 분석, 예측 및 기타 머신러닝 작업을 수행하며, 그 결과를 블록체인 상에 기록하고 공유

---

## 3. NAT 트래버설 전략

Donghae 프로젝트는 외부 피어가 내부 노드에 접근할 수 있도록 자동 포트 매핑을 설정하는 모듈을 통해 NAT 트래버설을 지원합니다.

- **NAT-PMP 우선 사용:**  
  - 간단한 프로토콜 구조와 낮은 메시지 오버헤드로 빠른 포트 매핑 설정을 제공  
  - macOS와 iOS 등 애플 생태계에서 NAT-PMP가 기본 활성화되어 있어 높은 신뢰성을 보장

- **UPnP 페일오버:**  
  - NAT-PMP 방식이 지원되지 않거나 실패할 경우, 대부분의 소비자용 라우터가 지원하는 UPnP를 통해 포트 매핑을 재시도  
  - 이 두 가지 방법의 조합은 Transmission의 검증된 전략을 따르며, 전체 성공률과 안정성을 극대화합니다.

---

## 4. 플랫폼 및 CoreML 서비스 통합

Donghae는 Mac 플랫폼에 최적화되어 있으며, CoreML를 서비스하는 블록체인으로서 다음을 제공합니다:

- **CoreML 통합:**  
  - 각 노드는 CoreML 모델을 로드하여 머신러닝 추론 기능을 수행  
  - 예측 결과는 블록체인에 기록되어, 분산형 데이터 분석 및 dApp 서비스에 활용됩니다.

- **Mac 전용 최적화:**  
  - Mac 하드웨어 및 소프트웨어 특성을 최대한 활용하여, 효율적이고 안정적인 서비스 환경을 구축  
  - 사용자 인터페이스 및 네트워크 설정은 Mac 환경에 최적화되어 제공됩니다.

---

## 5. 활용 오픈 소스

Donghae 프로젝트는 다음의 주요 오픈 소스 기술들을 활용합니다:

- **[Zig Language & Zig Standard Library](https://github.com/ziglang/zig)**  
  - Mac 전용 개발 환경에서 네트워크 인터페이스 열거, UDP 소켓 통신, 스레드, 메모리 관리 및 유닛 테스트 기능을 제공합니다.

- **[miniupnpc](http://miniupnp.free.fr/)**  
  - UPnP 프로토콜을 통해 라우터 검색 및 포트 매핑 설정/해제를 지원합니다.  
  - 소스 코드: [miniupnpc GitHub mirror](https://github.com/miniupnp/miniupnp)

- **[libnatpmp](https://miniupnp.tuxfamily.org/libnatpmp.html)**  
  - NAT-PMP 프로토콜을 통해 UPnP 방식이 실패할 경우 대체 수단으로 포트 매핑을 지원합니다.  
  - 소스 코드: [libnatpmp GitHub mirror](https://github.com/miniupnp/libnatpmp)

---

## 6. 테스트 및 배포 전략

- **유닛 테스트:**  
  - Zig의 내장 테스트 프레임워크를 활용하여 내부 IP 탐지, NAT 트래버설, 피어 디스커버리 등 각 모듈의 기능을 검증합니다.
  
- **배포:**  
  - 빌드 스크립트(`build.zig`)를 통해 전체 프로젝트를 컴파일하고 패키징  
  - 운영 환경에서는 Mac 전용 데몬 또는 백그라운드 프로세스로 실행되며, 로그 및 모니터링 시스템을 통해 안정적인 운영을 보장합니다.

---

## 7. 요약

Donghae는 Mac 플랫폼 전용으로 설계된 Zig 기반 블록체인 네트워크로, CoreML 서비스를 중심으로 다음을 제공합니다:

- **안전하고 효율적인 코드베이스:** Zig를 활용하여 높은 성능과 안정성을 확보
- **최적화된 네트워크 통신:** QUIC 프로토콜로 빠른 연결 수립과 암호화된 통신 제공
- **시간 순서 증명:** PoH를 통해 블록 생성 시간 및 순서의 무결성 보장
- **분산 합의:** Swarm Intelligence 기반의 합의 알고리즘으로 중앙 제어 없이 효율적 합의 도출
- **자동 NAT 트래버설:** NAT-PMP 우선, UPnP 페일오버 전략을 통해 외부 피어가 내부 노드에 접근할 수 있도록 자동 포트 매핑 설정
- **피어 디스커버리:** UDP 기반의 announce 메시지 교환으로 중앙 서버 없이 동적 피어 검색
- **CoreML 서비스 통합:** Mac에서 CoreML 모델을 실행하여 분산형 머신러닝 추론 서비스를 제공

Donghae는 이러한 기술과 전략을 통해, CoreML를 서비스하는 안정적이고 확장 가능한 블록체인 플랫폼으로 발전할 것을 목표로 합니다.
