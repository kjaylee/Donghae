# Donghae

**Donghae**는 각 가정의 Mac을 활용하여 신뢰할 수 있는 뉴럴 엔진(CoreML) 서비스를 제공하는, Zig 기반 블록체인 네트워크입니다.  
"동해(東海)"는 동쪽 바다의 넓고 깊은 이미지를 상징하며, Donghae는 CoreML의 강력한 머신러닝 기능을 분산형으로 제공하여, 확장성과 신뢰성을 확보하는 것을 목표로 합니다.

---

## 목차

- [Donghae](#donghae)
  - [목차](#목차)
  - [1. 프로젝트 개요](#1-프로젝트-개요)
  - [2. 주요 특징](#2-주요-특징)
  - [3. NAT 트래버설 전략](#3-nat-트래버설-전략)
  - [4. 플랫폼 및 CoreML 서비스 통합](#4-플랫폼-및-coreml-서비스-통합)
  - [5. Neural Engine Optimized Consensus with PoS](#5-neural-engine-optimized-consensus-with-pos)
  - [6. 추가 아이디어](#6-추가-아이디어)
  - [7. 활용 오픈 소스](#7-활용-오픈-소스)
  - [8. 테스트 및 배포 전략](#8-테스트-및-배포-전략)
  - [9. 요약](#9-요약)

---

## 1. 프로젝트 개요

Donghae는 집에 있는 Mac을 네트워크에 연결하여, 각 노드가 CoreML 기반 뉴럴 엔진을 실행함으로써 분산형 머신러닝 추론 서비스를 제공하는 블록체인 플랫폼입니다.  
Zig 언어로 구현된 Donghae는 낮은 오버헤드와 높은 성능을 바탕으로, 각 가정의 Mac에서 CoreML 모델을 직접 실행하고, 그 결과를 블록체인에 기록하여 신뢰성과 투명성을 보장합니다.

---

## 2. 주요 특징

1. **Zig 기반 안전하고 효율적인 코드베이스**  
   - Mac 전용 환경에 최적화된 코드를 제공하며, 강력한 컴파일 타임 검증으로 메모리 안전성과 신뢰성을 확보합니다.

2. **QUIC 프로토콜을 통한 네트워크 통신 최적화**  
   - 빠른 연결 수립과 낮은 지연 시간, 내장 TLS 1.3 암호화를 통해 보안성이 강화된 통신을 지원합니다.

3. **PoH (Proof of History)를 통한 시간 순서 증명**  
   - 블록 생성 시간과 순서를 암호학적으로 증명하여, 블록체인의 무결성을 유지합니다.

4. **Neural Engine Optimized Consensus with PoS**  
   - 각 노드는 CoreML 추론 결과와 함께 관련 증명(서명, 해시 등)을 제출하여, 결과의 신뢰성을 빠르게 검증합니다.
   - PoS(Proof of Stake) 메커니즘을 도입하여 노드가 일정량의 스테이크를 걸고, 정확하고 신속한 추론 결과를 제공하는 노드에 인센티브를 부여합니다.
   - 작업은 동적 병렬 처리로 분산되어, 빠른 노드는 더 많은 작업을 처리하고, 느린 노드도 자신의 속도에 맞게 기여할 수 있도록 최적화됩니다.

5. **자동 NAT 트래버설**  
   - **NAT-PMP 우선:**  
     - 간단한 프로토콜 구조와 낮은 메시지 오버헤드로 빠른 포트 매핑 설정이 가능하며, macOS 등 애플 생태계에서 높은 신뢰성을 제공합니다.
   - **UPnP 페일오버:**  
     - NAT-PMP가 지원되지 않거나 실패할 경우, 대부분의 소비자용 라우터에서 UPnP를 통해 포트 매핑을 재시도합니다.
   - 검증된 Transmission의 전략을 채택하여 전체 성공률과 안정성을 극대화합니다.

6. **피어 디스커버리**  
   - UDP 기반의 announce 메시지 교환을 통해 중앙 서버 없이 동적 피어 검색 및 네트워크 상태 갱신을 지원합니다.

7. **플랫폼 및 CoreML 서비스 통합**  
   - Mac 환경에 최적화되어 각 가정의 Mac에서 CoreML 모델을 직접 실행, 머신러닝 추론 서비스를 제공하고 그 결과를 블록체인에 기록합니다.

---

## 3. NAT 트래버설 전략

Donghae는 외부 피어가 집에 있는 Mac 내부의 CoreML 서비스에 접근할 수 있도록, 자동 포트 매핑 모듈을 통해 NAT 트래버설을 지원합니다.

- **NAT-PMP 우선 사용:**  
  - 간단한 프로토콜 구조와 낮은 메시지 오버헤드로 빠른 포트 매핑 설정을 제공  
  - macOS 및 애플 생태계에서 기본 활성화되어 높은 신뢰성을 보장

- **UPnP 페일오버:**  
  - NAT-PMP 방식이 지원되지 않거나 실패할 경우, UPnP를 통해 포트 매핑을 재시도하여 전체 성공률을 극대화

- **Transmission 전략 채택:**  
  - 검증된 NAT-PMP 우선, UPnP 페일오버 방식을 통해 외부 피어가 내부 Mac의 CoreML 서비스에 접근할 수 있도록 보장

---

## 4. 플랫폼 및 CoreML 서비스 통합

Donghae는 Mac 플랫폼에 최적화되어 있으며, CoreML 기반 뉴럴 엔진 서비스를 다음과 같이 제공합니다:

- **CoreML 통합:**  
  - 각 노드는 내장된 CoreML 뉴럴 엔진을 이용해 머신러닝 추론 작업을 수행  
  - 추론 결과는 블록체인에 기록되어 분산형 데이터 분석 및 dApp 서비스에 활용됩니다.

- **Mac 전용 최적화:**  
  - Mac 하드웨어(특히 Apple Silicon)와 소프트웨어의 강점을 최대한 활용하여, 효율적이고 안정적인 서비스 환경을 구축  
  - 사용자 인터페이스 및 네트워크 설정은 Mac 환경에 최적화되어 제공됩니다.

---

## 5. Neural Engine Optimized Consensus with PoS

Donghae의 합의 알고리즘은 CoreML 추론 결과의 정확성과 제출 속도뿐 아니라, 각 노드의 스테이크를 기반으로 하는 PoS 메커니즘을 도입하여 신뢰성과 경제적 인센티브를 제공합니다.

- **추론 결과 증명:**  
  - 각 노드는 CoreML 추론 결과와 함께 디지털 서명, 해시 등의 증명을 제출하여 결과의 신뢰성을 검증합니다.

- **PoS 기반 인센티브:**  
  - 노드들은 일정량의 스테이크를 걸고, 정확하고 신속한 추론 결과를 제출하면 보상을 받습니다.
  - 이를 통해 성능 차이로 인한 소외를 방지하고, 모든 노드가 공정하게 참여할 수 있는 환경을 조성합니다.

- **동적 작업 스케줄링:**  
  - 작업 큐와 병렬 처리 시스템을 도입하여, 빠른 노드는 더 많은 작업을, 느린 노드는 자신의 속도에 맞게 작업을 수행하도록 하여 전체 처리량을 극대화합니다.

- **낮은 지연 및 높은 처리량:**  
  - 최적화된 합의 프로세스는 머신러닝 추론의 결과를 신속하게 통합하고, 블록체인 상태를 효율적으로 업데이트합니다.

---

## 6. 추가 아이디어

Donghae 프로젝트는 CoreML 서비스와 블록체인 네트워크의 확장성을 강화하기 위해 다음과 같은 추가 아이디어를 고려합니다:

- **스마트 컨트랙트를 통한 CoreML 모델 업데이트 및 배포:**  
  - 분산형 스마트 컨트랙트를 사용해 최신 CoreML 모델의 자동 업데이트와 버전 관리를 수행

- **토큰화 및 인센티브 메커니즘:**  
  - 노드가 CoreML 추론 서비스를 제공할 때 토큰 보상 및 인센티브를 지급하여, 경제적 동기를 강화

- **연합 학습 지원:**  
  - 각 Mac에서 학습한 모델 파라미터를 분산 방식으로 집계하여, 중앙 서버 없이 모델을 업데이트

- **에지 컴퓨팅 통합:**  
  - 각 노드를 에지 컴퓨팅 리소스로 활용해 지역별로 빠른 응답과 낮은 지연을 보장

- **고급 모니터링 및 관리 대시보드:**  
  - 각 노드의 CoreML 성능, 네트워크 상태, 자원 사용률 등을 실시간 모니터링하여 운영자가 빠르게 대응할 수 있도록 지원

- **분산 ID 및 인증 체계 (DID):**  
  - 탈중앙화된 ID 시스템을 도입하여 노드의 신뢰성과 보안을 강화

- **컨테이너 및 오케스트레이션 지원:**  
  - Docker, Kubernetes 등을 도입해 각 Mac 노드의 소프트웨어 배포 및 관리를 자동화

- **모듈식 전송 프로토콜 지원:**  
  - 향후 필요에 따라 QUIC와 같은 최신 전송 프로토콜을 도입하여, 네트워크 성능과 보안성을 상황에 맞게 조정

- **분산 데이터 스토리지 및 상태 관리 강화:**  
  - IPFS, Filecoin 등과 연계하여 대용량 데이터의 분산 저장과 효율적 상태 관리를 구현

---

## 7. 활용 오픈 소스

Donghae 프로젝트는 다음의 주요 오픈 소스 기술들을 활용합니다:

- **[Zig Language & Zig Standard Library](https://github.com/ziglang/zig)**  
  - Mac 전용 개발 환경에서 네트워크 인터페이스 열거, UDP 통신, 스레드, 메모리 관리 및 유닛 테스트 기능 제공

- **[miniupnpc](http://miniupnp.free.fr/)**  
  - UPnP 프로토콜을 통해 라우터 검색 및 포트 매핑 설정/해제를 지원  
  - [miniupnpc GitHub mirror](https://github.com/miniupnp/miniupnp)

- **[libnatpmp](https://miniupnp.tuxfamily.org/libnatpmp.html)**  
  - NAT-PMP 프로토콜을 통해 UPnP 방식이 실패할 경우 대체 수단으로 포트 매핑 지원  
  - [libnatpmp GitHub mirror](https://github.com/miniupnp/libnatpmp)

---

## 8. 테스트 및 배포 전략

- **유닛 테스트:**  
  - Zig의 내장 테스트 프레임워크를 활용하여 내부 IP 탐지, NAT 트래버설, 피어 디스커버리, 그리고 합의 관련 기능을 철저히 검증합니다.

- **배포:**  
  - 빌드 스크립트(`build.zig`)를 통해 전체 프로젝트를 컴파일 및 패키징  
  - 운영 환경에서는 Mac 전용 데몬 또는 백그라운드 프로세스로 실행되며, 로그 및 모니터링 시스템을 통해 안정적인 운영을 보장합니다.

---

## 9. 요약

Donghae는 각 가정의 Mac을 활용하여 CoreML 기반 뉴럴 엔진 서비스를 신뢰할 수 있게 제공하는 블록체인 플랫폼입니다.  
주요 기능은 다음과 같습니다:

- **안전하고 효율적인 Zig 기반 코드베이스:**  
  Mac 전용 환경에 최적화되어 높은 성능과 안정성을 제공합니다.

- **최적화된 네트워크 통신:**  
  QUIC 프로토콜을 통한 빠른 연결 및 암호화된 통신으로, 분산 네트워크에서 안정적인 데이터 전송을 지원합니다.

- **시간 순서 증명:**  
  PoH를 통해 블록 생성 시간 및 순서의 무결성을 보장합니다.

- **Neural Engine Optimized Consensus with PoS:**  
  각 노드가 CoreML 추론 결과와 함께 증명 정보를 제출하며, PoS 기반 인센티브를 통해 정확하고 신속한 결과를 보상받아, 효율적인 합의를 도출합니다.

- **자동 NAT 트래버설:**  
  NAT-PMP 우선, UPnP 페일오버 전략을 채택하여 외부 피어가 내부 Mac의 CoreML 서비스에 안전하게 접근할 수 있도록 포트 매핑을 자동 설정합니다.

- **피어 디스커버리:**  
  UDP 기반의 announce 메시지 교환을 통해 중앙 서버 없이 동적 피어 검색 및 네트워크 상태 갱신을 지원합니다.

- **플랫폼 및 CoreML 서비스 통합:**  
  Mac 하드웨어와 소프트웨어를 최대한 활용하여, 각 가정의 Mac에서 CoreML 모델을 실행, 분산형 머신러닝 추론 서비스를 제공하며 그 결과를 블록체인에 기록합니다.

Donghae는 이러한 통합된 기술과 추가 아이디어들을 바탕으로, 집에 있는 Mac을 활용하여 신뢰할 수 있는 CoreML 서비스를 제공하는 글로벌 블록체인 플랫폼으로 발전할 것을 목표로 합니다.
